---
title: "Costs and Resource Utilization"
output: html_document
---

# Overview

This document outlines the steps taken to determine input values for the payoff module. 

## Step 1: Estimating annual COPD medication costs

To estimate the annual cost of COPD medications, the following two components were used:

1. **Average monthly GoodRx prices**  
   - Based on the average price of the most commonly prescribed inhalers within each drug class  
   - All prices reflect 2025 USD

2. **Real-world annual prescription fill frequency**  
   - Derived from the following published sources:
     - **Mannino et al., 2022** (DOI: 10.1016/j.rmed.2022.106807)
     - **Bengtson et al., 2018** (DOI: 10.1177/1753466618772750)


#### Dispense frequency per Year

**Mannino et al. 2022:**

- ICS + LAMA + LABA: 6.1  
- ICS-containing regimens: 5.3  
- LAMA-containing regimens: 5.2  
- LABA-containing regimens: 5.5  

**Bengtson et al. 2018:**

- SABA: 12.0  

#### Assumptions for combination therapies

For combination therapies not explicitly categorized, the midpoint of class dispensing frequencies was used:

- ICS + LABA: 5.4  
- LAMA + LABA: 5.35

Note: The real-world prescription fill data inherently reflects non-adherence,thus the adherence parameter in EPIC will be set to 1 to avoid double-adjusting for adherence

```{r, eval = TRUE, echo = FALSE}

library(knitr)

drug_costs <- data.frame(
  class = c("ICS + LAMA + LABA", "ICS+LABA", "LAMA", "LAMA+LABA", "SABA"),
  monthly_cost = c(653, 227, 334, 420, 31),
  dispenses_per_year = c(6.1, 5.4, 5.2, 5.35, 12)
)

drug_costs$annual_cost <- round(drug_costs$monthly_cost * drug_costs$dispenses_per_year, 2)

kable(drug_costs,
      col.names = c("Drug Class", "Monthly Cost (USD)", "Dispenses/Year", "Estimated Annual Cost (USD)"),
      format.args = list(big.mark = ","),
      caption = "Estimated Annual COPD Inhaler Costs by Drug Class")

```

## Step 2: Estimating COPD-related background costs by GOLD stage

COPD-related background costs were estimated using data from Wallace et al 2019 (DOI: 10.18553/jmcp.2019.25.2.205) Table 3, specifically the row labeled "COPD-related costs, all patients". Background costs were calculated by subtracting the costs of **Inpatient Care**, **Emergency Room (ER) Visits**, and **Pharmacy** from the **Total COPD-related Medical Costs** (2016 Costs USD). 

```{r, eval = TRUE, echo = FALSE}

copd_background_costs <- data.frame(
  `GOLD Stage` = c("GOLD I", "GOLD II", "GOLD III", "GOLD IV"),
  `Total COPD Cost` = c(5945, 6978, 10751, 18070),
  `Inpatient` = c(3853, 4449, 6277, 12139),
  `ER Visits` = c(186, 144, 193, 534),
  `Pharmacy` = c(592, 1101, 2000, 2479),
  `Background Cost` = c(1314, 1284, 2281, 2918)
)

kable(copd_background_costs,
      col.names = c("GOLD Stage", "Total COPD-related Medical Costs", "Inpatient", "ER Visits", "Pharmacy", "Background Cost (USD)"),
      format.args = list(big.mark = ","),
      caption = "COPD-related Background Costs by GOLD Stage")

```

## Step 3: Estimating exacerbation costs by severity

The exacerbation module assigns costs to events based on severity: **Mild**, **Moderate**, **Severe**, and **Very Severe**. These estimates were derived from U.S.-based healthcare cost studies and represent per-event direct medical costs.

The following references were used:

- **Dalal et al., 2011** (DOI: 10.1016/j.rmed.2010.09.003) — 2008 Costs USD  
- **Bogart et al., 2020** (DOI: 10.37765/ajmc.2020.43157) — 2017 Costs USD

```{r, eval = TRUE, echo = FALSE}

exacerbation_costs <- data.frame(
  `Exacerbation Severity` = c("Mild", "Moderate", "Severe", "Very Severe"),
  `Definition` = c(
    "ED visit (Dalal et al. 2011)",
    "No hospitalization (Bogart et al. 2020)",
    "Inpatient hospitalization (Bogart et al. 2020)",
    "ICU + intubation (Dalal et al. 2011)"
  ),
  `Cost (USD)` = c(606, 2107, 22729, 44909)
)

kable(exacerbation_costs,
      col.names = c("Exacerbation Severity", "Definition", "Cost (USD)"),
      format.args = list(big.mark = ","),
      caption = "Per-Event COPD Exacerbation Costs by Severity")

```

## Step 4: Estimating costs for smoking cessation 

According to the MMWR study (DOI: 10.15585/mmwr.mm7329a1) the most commonly used smoking cessation pharmacotherapies among individuals attempting to quit were as follows:

- **Nicotine patch**: 19.6%  
- **Nicotine gum/lozenge**: 18.4%  
- **Nicotine spray/inhaler**: 1.0%  
- **Varenicline**: 9.6%  
- **Bupropion**: 6.4%  

### Reweighted to assume 100% uptake:

- **Nicotine patch**: (19.6 / 55.0) × 100 ≈ 35.6%  
- **Nicotine gum/lozenge**: (18.4 / 55.0) × 100 ≈ 33.5%  
- **Nicotine spray/inhaler**: (1.0 / 55.0) × 100 ≈ 1.8%  
- **Varenicline**: (9.6 / 55.0) × 100 ≈ 17.5%  
- **Bupropion**: (6.4 / 55.0) × 100 ≈ 11.6%  

### Estimated 3-Month cost of smoking cessation therapy

Cost estimates were derived from GoodRx (2025 Costs USD) for 3 months of smoking cessation therapy:

- **Nicotine patch**: \$71  
- **Nicotine gum/lozenge**: \$35  
- **Nicotine spray/inhaler**: \$550  
- **Varenicline**: \$402  
- **Bupropion**: \$25  

Using the reweighted proportions, the weighted average cost for 3 months of smoking cessation pharmacotherapy was calculated as:

**Average cost**: \$120.15

```{r, eval = TRUE, echo = FALSE}

smoking_cessation <- data.frame(
  Pharmacotherapy = c("Nicotine Patch", "Nicotine Gum/Lozenge", "Nicotine Spray/Inhaler", 
                      "Varenicline", "Bupropion", "Average (weighted)"),
  Reweighted_Proportion = c(35.6, 33.5, 1.8, 17.5, 11.6, "--"),
  Cost = c(71, 35, 550, 402, 25, 120.15)
)

kable(smoking_cessation,
      col.names = c("Pharmacotherapy", "Reweighted Proportion (%)", "Cost (USD) "),
      format.args = list(big.mark = ",", nsmall = 2),
      caption = "Smoking Cessation Therapy Use and Cost Estimates")

```

## Step 5: Estimating costs for GP visit and diagnostic spirometry 

**GP visits**.  
Medicare pays providers approximately $89 and $125 for a 99214 visit in a typical outpatient setting (Source: https://college.acaai.org/wp-content/uploads/2024/07/2025-Proposed-RVUs-and-Reimbursement-for-Allergy.pdf). A midpoint of $107 was used (2025 cost)

**Spirometry**. 
CMS CPT code 94060 was used which equates to $41 (2025 Costs USD)

